@model UserState
@inject IUserRetrievalShim UserRetrievalShim
@inject ITimeFormatStringService TimeFormatStringService
@{
	var serialized = JsonSerializer.Serialize(Model, new JsonSerializerOptions{ PropertyNamingPolicy = JsonNamingPolicy.CamelCase });
	var user = UserRetrievalShim.GetUser();
}
<script>
	PopForums.LocalizationService.init();
	@if (user != null)
{<text>
	PopForums.userState = Object.assign(new PopForums.UserState(), @Html.Raw(serialized));
    PopForums.userState.initialize();
</text>}
</script>